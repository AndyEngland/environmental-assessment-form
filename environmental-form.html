<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environmental Assessment Study - Response Form</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .form-container {
            padding: 2rem;
        }

        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #4caf50;
        }

        .form-section h2 {
            color: #2e7d32;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .required {
            color: #d32f2f;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="url"],
        textarea,
        select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus,
        input[type="url"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #4caf50;
        }

        textarea {
            resize: vertical;
            min-height: 120px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 0.75rem;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            background: white;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin-right: 0.5rem;
            transform: scale(1.2);
        }

        .checkbox-item label {
            margin-bottom: 0;
            font-weight: normal;
            cursor: pointer;
            flex: 1;
        }

        .file-upload {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .file-upload input[type="file"] {
            flex: 1;
            min-width: 200px;
        }

        .file-info {
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.5rem;
        }

        .submit-section {
            text-align: center;
            padding: 2rem;
            background: #f8f9fa;
            margin-top: 2rem;
        }

        .submit-btn {
            background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 6px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .privacy-notice {
            margin-top: 1rem;
            padding: 1rem;
            background: #e8f5e8;
            border-radius: 6px;
            font-size: 0.9rem;
            color: #2e7d32;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 1rem;
            color: #4caf50;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4caf50;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message {
            display: none;
            background: #d4edda;
            color: #155724;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 1rem;
            text-align: center;
        }

        .error-message {
            display: none;
            background: #f8d7da;
            color: #721c24;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 1rem;
            text-align: center;
        }

        /* ADD YOUR NEW CSS HERE */
        .logo-container {
            margin-bottom: 1rem;
        }

        .logo {
            max-height: 80px;
            max-width: 200px;
            height: auto;
            width: auto;
        }

        @media (max-width: 600px) {
            .header {
                padding: 1.5rem;
            }
            
            .form-container {
                padding: 1rem;
            }
            
            .form-section {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-container">
        <img src="logo.png" alt="Organization Logo" class="logo">
        </div>
            <h1>Environmental Assessment Study</h1>
            <p>Collaboration & Information Request Form</p>
            <p><em>West Coast Biosphere Reserve - Yzerfontein Urban Conservancy</em></p>
        </div>

        <div class="form-container">
            <form id="responseForm">
                <!-- Contact Information Section -->
                <div class="form-section">
                    <h2>Contact Information</h2>
                    <div class="form-group">
                        <label for="name">Name <span class="required">*</span></label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="organization">Organization <span class="required">*</span></label>
                        <input type="text" id="organization" name="organization" required>
                    </div>
                    <div class="form-group">
                        <label for="position">Position/Title</label>
                        <input type="text" id="position" name="position">
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address <span class="required">*</span></label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" name="phone">
                    </div>
                    <div class="form-group">
                        <label for="website">Organization Website</label>
                        <input type="url" id="website" name="website">
                    </div>
                </div>

                <!-- Organization Type Section -->
                <div class="form-section">
                    <h2>Organization Type</h2>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="org_ngo" name="org_type" value="NGO">
                            <label for="org_ngo">NGO/Non-profit</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="org_government" name="org_type" value="Government">
                            <label for="org_government">Government Department</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="org_university" name="org_type" value="University">
                            <label for="org_university">University/Research Institution</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="org_private" name="org_type" value="Private">
                            <label for="org_private">Private Organization</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="org_other" name="org_type" value="Other">
                            <label for="org_other">Other (please specify in comments)</label>
                        </div>
                    </div>
                </div>

                <!-- Existing Studies Section -->
                <div class="form-section">
                    <h2>Existing Studies & Data</h2>
                    <div class="form-group">
                        <label for="existing_studies">Do you have existing studies or data for our study area?</label>
                        <select id="existing_studies" name="existing_studies">
                            <option value="">Please select</option>
                            <option value="yes">Yes, we have relevant studies/data</option>
                            <option value="planned">We have planned studies</option>
                            <option value="no">No existing studies</option>
                            <option value="unsure">Unsure/need to check</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="study_details">Please describe any existing or planned studies:</label>
                        <textarea id="study_details" name="study_details" placeholder="Include study names, dates, scope, key findings, etc."></textarea>
                    </div>
                </div>

                <!-- Collaboration Opportunities Section -->
                <div class="form-section">
                    <h2>Collaboration Opportunities</h2>
                    <p style="margin-bottom: 1rem;">Please indicate areas where you could contribute:</p>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_expertise" name="collaboration" value="Technical Expertise">
                            <label for="collab_expertise">Technical Expertise</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_fieldwork" name="collaboration" value="Field Work">
                            <label for="collab_fieldwork">Field Work Support</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_data" name="collaboration" value="Data Sharing">
                            <label for="collab_data">Data Sharing</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_funding" name="collaboration" value="Funding">
                            <label for="collab_funding">Funding Support</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_equipment" name="collaboration" value="Equipment">
                            <label for="collab_equipment">Equipment/Resources</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_students" name="collaboration" value="Student Projects">
                            <label for="collab_students">Student Research Projects</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_analysis" name="collaboration" value="Data Analysis">
                            <label for="collab_analysis">Data Analysis</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_gis" name="collaboration" value="GIS Mapping">
                            <label for="collab_gis">GIS Mapping</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_regulatory" name="collaboration" value="Regulatory Guidance">
                            <label for="collab_regulatory">Regulatory Guidance</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="collab_networking" name="collaboration" value="Networking">
                            <label for="collab_networking">Networking/Connections</label>
                        </div>
                    </div>
                </div>

                <!-- Expertise Areas Section -->
                <div class="form-section">
                    <h2>Areas of Expertise</h2>
                    <div class="form-group">
                        <label for="expertise">Please describe your organization's relevant expertise:</label>
                        <textarea id="expertise" name="expertise" placeholder="e.g., fynbos ecology, coastal conservation, species monitoring, EIA processes, etc."></textarea>
                    </div>
                </div>

                <!-- File Upload Section -->
                <div class="form-section">
                    <h2>Document Sharing</h2>
                    <div class="form-group">
                        <label for="documents">Upload relevant documents (optional):</label>
                        <div class="file-upload">
                            <input type="file" id="documents" name="documents" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.kml,.shp,.zip">
                        </div>
                        <div class="file-info">
                            Accepted formats: PDF, Word, Excel, KML, Shapefile, ZIP (Max 10MB per file)
                        </div>
                    </div>
                </div>

                <!-- Comments Section -->
                <div class="form-section">
                    <h2>Additional Comments</h2>
                    <div class="form-group">
                        <label for="comments">Please share any additional thoughts, suggestions, or questions:</label>
                        <textarea id="comments" name="comments" placeholder="Any other information you'd like to share about this project..."></textarea>
                    </div>
                </div>

                <!-- Follow-up Section -->
                <div class="form-section">
                    <h2>Follow-up Preferences</h2>
                    <div class="form-group">
                        <label for="followup">How would you prefer to be contacted for follow-up?</label>
                        <select id="followup" name="followup">
                            <option value="email">Email</option>
                            <option value="phone">Phone</option>
                            <option value="meeting">In-person meeting</option>
                            <option value="video">Video call</option>
                            <option value="no_followup">No follow-up needed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="best_time">Best time to contact you:</label>
                        <input type="text" id="best_time" name="best_time" placeholder="e.g., Weekday mornings, Tuesday afternoons, etc.">
                    </div>
                </div>

                <!-- Submit Section -->
                <div class="submit-section">
                    <button type="submit" class="submit-btn" id="submitBtn">Submit Response</button>
                    
                    <div class="loading" id="loading">
                        <div class="spinner"></div>
                        <p>Processing your submission...</p>
                    </div>
                    
                    <div class="success-message" id="successMessage">
                        <h3>✓ Thank you for your submission!</h3>
                        <p>Your response has been received and you've been added to our project updates list. We'll be in touch soon!</p>
                    </div>
                    
                    <div class="error-message" id="errorMessage">
                        <h3>⚠ Submission Error</h3>
                        <p>There was an issue processing your submission. Please try again or contact us directly.</p>
                    </div>
                    
                    <div class="privacy-notice">
                        <strong>Privacy Notice:</strong> Your information will be used solely for this environmental assessment project and will be handled in accordance with applicable data protection laws. We will not share your contact details with third parties without your consent.
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Configuration - Replace with your actual values
        const CONFIG = {
            MAILCHIMP_API_KEY: 'YOUR_MAILCHIMP_API_KEY', // Replace with your API key
            MAILCHIMP_SERVER: 'us1', // Replace with your server prefix (e.g., us1, us2, etc.)
            MAILCHIMP_LIST_ID: 'YOUR_LIST_ID', // Replace with your audience/list ID
            NOTIFICATION_EMAIL: 'your-email@domain.com', // Replace with your email
            EMAILJS_SERVICE_ID: 'YOUR_EMAILJS_SERVICE_ID', // For email notifications
            EMAILJS_TEMPLATE_ID: 'YOUR_EMAILJS_TEMPLATE_ID',
            EMAILJS_USER_ID: 'YOUR_EMAILJS_USER_ID'
        };

        // Initialize EmailJS (for email notifications)
        // You'll need to sign up at https://www.emailjs.com/ for email notifications
        // emailjs.init(CONFIG.EMAILJS_USER_ID);

        document.getElementById('responseForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const loading = document.getElementById('loading');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            
            // Reset messages
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            
            // Basic form validation
            const name = document.getElementById('name').value.trim();
            const organization = document.getElementById('organization').value.trim();
            const email = document.getElementById('email').value.trim();
            
            if (!name || !organization || !email) {
                alert('Please fill in all required fields marked with *');
                return;
            }
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Please enter a valid email address');
                return;
            }
            
            // Show loading state
            submitBtn.disabled = true;
            loading.style.display = 'block';
            
            try {
                // Collect form data
                const formData = collectFormData();
                
                // Submit to Mailchimp and send email notification
                const results = await Promise.allSettled([
                    addToMailchimp(formData),
                    sendEmailNotification(formData)
                ]);
                
                const mailchimpResult = results[0];
                const emailResult = results[1];
                
                if (mailchimpResult.status === 'fulfilled') {
                    successMessage.style.display = 'block';
                    this.reset(); // Clear the form
                    
                    // Scroll to success message
                    successMessage.scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error('Failed to add to Mailchimp');
                }
                
            } catch (error) {
                console.error('Submission error:', error);
                errorMessage.style.display = 'block';
                errorMessage.scrollIntoView({ behavior: 'smooth' });
            } finally {
                // Hide loading state
                submitBtn.disabled = false;
                loading.style.display = 'none';
            }
        });

        function collectFormData() {
            const form = document.getElementById('responseForm');
            const formData = new FormData(form);
            const data = {};
            
            // Collect regular form fields
            for (let [key, value] of formData.entries()) {
                if (data[key]) {
                    // Handle multiple values (checkboxes)
                    if (Array.isArray(data[key])) {
                        data[key].push(value);
                    } else {
                        data[key] = [data[key], value];
                    }
                } else {
                    data[key] = value;
                }
            }
            
            // Convert arrays to comma-separated strings for email
            Object.keys(data).forEach(key => {
                if (Array.isArray(data[key])) {
                    data[key] = data[key].join(', ');
                }
            });
            
            return data;
        }

        async function addToMailchimp(data) {
            // Note: This is a simplified example. In production, you should use a serverless function
            // or backend API to handle Mailchimp API calls due to CORS restrictions.
            
            const mailchimpData = {
                email_address: data.email,
                status: 'subscribed',
                merge_fields: {
                    FNAME: data.name.split(' ')[0] || '',
                    LNAME: data.name.split(' ').slice(1).join(' ') || '',
                    ORG: data.organization || '',
                    POSITION: data.position || '',
                    PHONE: data.phone || '',
                    WEBSITE: data.website || ''
                },
                tags: ['Environmental Assessment', 'Collaboration Form']
            };
            
            // This would typically be handled by your backend/serverless function
            // const response = await fetch(`https://${CONFIG.MAILCHIMP_SERVER}.api.mailchimp.com/3.0/lists/${CONFIG.MAILCHIMP_LIST_ID}/members`, {
            //     method: 'POST',
            //     headers: {
            //         'Authorization': `apikey ${CONFIG.MAILCHIMP_API_KEY}`,
            //         'Content-Type': 'application/json'
            //     },
            //     body: JSON.stringify(mailchimpData)
            // });
            
            // For demonstration, we'll simulate a successful response
            console.log('Would add to Mailchimp:', mailchimpData);
            return Promise.resolve({ status: 'success' });
        }

        async function sendEmailNotification(data) {
            // Using EmailJS for email notifications
            // You'll need to set up EmailJS templates and service
            
            const templateData = {
                to_email: CONFIG.NOTIFICATION_EMAIL,
                from_name: data.name,
                from_email: data.email,
                subject: `New Environmental Assessment Response from ${data.organization}`,
                message: formatEmailContent(data)
            };
            
            // This would use EmailJS in production
            // return emailjs.send(CONFIG.EMAILJS_SERVICE_ID, CONFIG.EMAILJS_TEMPLATE_ID, templateData);
            
            // For demonstration, we'll simulate a successful response
            console.log('Would send email notification:', templateData);
            return Promise.resolve({ status: 'success' });
        }

        function formatEmailContent(data) {
            return `
New Environmental Assessment Response

Contact Information:
- Name: ${data.name}
- Organization: ${data.organization}
- Position: ${data.position || 'Not specified'}
- Email: ${data.email}
- Phone: ${data.phone || 'Not specified'}
- Website: ${data.website || 'Not specified'}

Organization Type: ${data.org_type || 'Not specified'}

Existing Studies: ${data.existing_studies || 'Not specified'}
Study Details: ${data.study_details || 'Not specified'}

Collaboration Areas: ${data.collaboration || 'Not specified'}

Expertise: ${data.expertise || 'Not specified'}

Additional Comments: ${data.comments || 'Not specified'}

Follow-up Preference: ${data.followup || 'Email'}
Best Time to Contact: ${data.best_time || 'Not specified'}

Submitted: ${new Date().toLocaleString()}
            `.trim();
        }
    </script>
</body>
</html>